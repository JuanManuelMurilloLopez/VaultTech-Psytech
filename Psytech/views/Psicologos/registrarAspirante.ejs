<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Registrar aspirante</title>
    <!-- Bootstrap CSS -->
    <link href=
    "https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" 
    rel="stylesheet">
    <!-- Link css -->
    <link rel="stylesheet" href="/css/psicologos/registrarAspirante.css">
    <!-- CSS navside -->
    <link rel="stylesheet" href="/css/includeCss/_navsidePsicologo.css">
    <!-- CSS cerrar sesión -->
    <link rel="stylesheet" href="/css/includeCss/_buttonCerrarSesion.css">
</head>

<body>

    <div class="main">

        <!-- Navside -->
        <%- include('../includes/_navsidePsicologo.ejs') %>

        <div class="container">

            <!-- Boton de cerrar sesión -->
            <%- include('../includes/_buttonCerrarSesion.ejs') %>

            <div>
                <h1 class="text-center">REGISTRAR NUEVO ASPIRANTE</h1>
            </div>
            <div>
                <form action="" method="POST">
    
                    <!--Input nombre-->
                    <div class="form-floating mb-3">
                        <input type="" class="form-control"  id="nombreUsuario" placeholder="Juan" name="nombreUsuario" required>
                        <label class="form-label" for="nombreUsuario">Nombre</label>
                    </div>
    
                    <!--Input Apellido Paterno-->
                    <div class="form-floating mb-3">
                        <input type="" class="form-control" id="apellidoPaterno" placeholder="Pérez" name="apellidoPaterno" required>
                        <label class="form-label" for="apellidoPaterno">Apellido Paterno</label>
                    </div>
    
                    <!--Input Apellido Materno-->
                    <div class="form-floating mb-3">    
                        <input type="" class="form-control" id="apellidoMaterno" placeholder="Pérez" name="apellidoMaterno">
                        <label class="form-label" for="apellidoMaterno">Apellido Materno</label>
                    </div>
    
                    <!--Input institución de procedencia-->
                    <div class="form-floating mb-3">
                        <input type="" class="form-control" id="institucionProcedencia" placeholder="Tec de Monterrey" name="institucionProcedencia" required>
                        <label class="form-label" for="institucionProcedencia">Institución de Procedencia</label>
                    </div>
    
                    <!--Input Correo-->
                    <div class="form-floating mb-3">
                        <input type="email" class="form-control" id="correo" placeholder="ejemplo@gmail.com" name="correo" required>
                        <label class="form-label" for="correo">Correo</label>
                    </div>
    
                    <!--Input Lada-->
                    <div class="form-floating mb-3">
                        <input type="number" class="form-control" id="lada" placeholder="52" name="lada" required>
                        <label class="form-label" for="lada">Lada telefónica</label>
                    </div>
    
                    <!--Input Número de teléfono-->
                    <div class="form-floating mb-3">
                        <input type="number" class="form-control" id="numeroTelefono" placeholder="1234567890" name="numeroTelefono" required>
                        <label class="form-label" for="numeroTelefono">Número de teléfono</label>
                    </div>
    
                    <!--Input País de origen-->
                    <div class="mb-3">
                        <label class="form-label" for="idPais">País de origen</label> <br>
    
                        <select class="form-select" name="idPais" id="idPais">
                            <% for(pais of paises){ %>
                                <option value="<%= pais.idPais %>"> <%= pais.nombrePais %> </option>
                            <% } %>
                        </select>
    
                    </div>
    
                    <!--Input Estado-->
                    <div class="mb-3">
                        <label class="form-label" for="idEstado">Estado de residencia</label> <br>
    
                        <select class="form-select" name="idEstado" id="iEstado">
                            <% for(estado of estados){ %>
                                <option value="<%= estado.idEstado %>"> <%= estado.nombreEstado %> </option>
                            <% } %>
                        </select>
    
                    </div>

                        <br><br>

                    <div class="d-flex justify-content-between mb-4">
                        <a href="/psicologo/informacion-grupos/<%= idGrupo %>/<%= idInstitucion %>" class="btn btn-color--third">Regresar</a> 
                    <button class="btn btn-color--secondary" type="submit">Guardar</button>
                    </div>
    
                </form>
            </div>
            
            <br>
            <div>
            </div>
        </div>
    </div>
    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Incluir el script del navside -->
    <script src="/js/_navside.js"></script>

    <script>

        const correosRegistrados = <%- JSON.stringify(correosRegistrados) %>;

        console.log(correosRegistrados);

        document.addEventListener('DOMContentLoaded', function() {
            const form = document.querySelector('form');
            const correoInput = document.getElementById('correo');

            form.addEventListener('submit', function(event){
                const correoIngresado = correoInput.value.trim().toLowerCase();

                const correoExistente = correosRegistrados.some(correo => correo.correo.toLowerCase() === correoIngresado);
                console.log(correoExistente);
                if(correoExistente){
                    event.preventDefault();
                    alert('Este correo ya está registrado');
                    correoInput.focus();
                }
            })
        })
    </script>

</body>
</html>