<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Análisis Hartman</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- Link css -->
    <link rel="stylesheet" href="/css/psicologos/analisisHartman.css" />

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <!-- CSS navside -->
    <link rel="stylesheet" href="/css/includeCss/_navsidePsicologo.css">
    <!-- CSS cerrar sesión -->
    <link rel="stylesheet" href="/css/includeCss/_buttonCerrarSesion.css">
</head>

<body class="d-flex">
    <div class="main d-flex w-100">
        <%- include('../includes/_navsidePsicologo.ejs') %>

        <div class="container">
            <%- include('../includes/_buttonCerrarSesion.ejs') %>
            <div class="text-center mb-4">
                <h2 class="fw-bold">Análisis Prueba Hartman</h2>
                <h4>
                    <%= analisisHartman[0].nombreAspirante %>
                    <%= analisisHartman[0].apellidoPaternoAspirante %>
                    <%= analisisHartman[0].apellidoMaternoAspirante %>
                </h4>
            </div>

            <div class="card shadow-sm p-4 mb-5 bg-white rounded">
                <!-- Importante: Eliminando estilo en línea y usando una clase en su lugar -->
                <div class="chart-container mb-4">
                    <canvas id="chart"></canvas>
                </div>

                <!-- Mundo Interno -->
                <h5 class="fw-semibold mt-4">Mundo Interno - Citas</h5>
                <div class="table-responsive">
                    <table class="table table-bordered table-sm table-hover align-middle">
                        <thead class="table-dark">
                            <tr>
                                <th>Dim I</th>
                                <th>Dim E</th>
                                <th>Dim S</th>
                                <th>Dim General</th>
                                <th>Dim %</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><%= analisisHartman[0].citaDimI %></td>
                                <td><%= analisisHartman[0].citaDimE %></td>
                                <td><%= analisisHartman[0].citaDimS %></td>
                                <td><%= analisisHartman[0].citaDimGeneral %></td>
                                <td><%= analisisHartman[0].citaDimPorcentaje %></td>
                            </tr>
                            <tr class="table-primary">
                                <th>Int I</th><th>Int E</th><th>Int S</th><th>Int General</th><th>Int %</th>
                            </tr>
                            <tr>
                                <td><%= analisisHartman[0].citaIntI %></td>
                                <td><%= analisisHartman[0].citaIntE %></td>
                                <td><%= analisisHartman[0].citaIntS %></td>
                                <td><%= analisisHartman[0].citaIntGeneral %></td>
                                <td><%= analisisHartman[0].citaIntPorcentaje %></td>
                            </tr>
                            <tr class="table-secondary">
                                <th>D.I</th><th>DIF</th><th>DIS</th><th>Sq1</th><th>Sq2</th><th>Ai%</th>
                            </tr>
                            <tr>
                                <td><%= analisisHartman[0].citaDi %></td>
                                <td><%= analisisHartman[0].citaDif %></td>
                                <td><%= analisisHartman[0].citaDIS %></td>
                                <td><%= analisisHartman[0].citaSQ1 %></td>
                                <td><%= analisisHartman[0].citaSQ2 %></td>
                                <td><%= analisisHartman[0].citaAiPorcentaje %></td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- Mundo Externo -->
                <h5 class="fw-semibold mt-5">Mundo Externo - Frases</h5>
                <div class="table-responsive">
                    <table class="table table-bordered table-sm table-hover align-middle">
                        <thead class="table-dark">
                            <tr>
                                <th>Dim I</th><th>Dim E</th><th>Dim S</th><th>Dim General</th><th>Dim %</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><%= analisisHartman[0].fraseDimI %></td>
                                <td><%= analisisHartman[0].fraseDimE %></td>
                                <td><%= analisisHartman[0].fraseDimS %></td>
                                <td><%= analisisHartman[0].fraseDimGeneral %></td>
                                <td><%= analisisHartman[0].fraseDimPorcentaje %></td>
                            </tr>
                            <tr class="table-primary">
                                <th>Int I</th><th>Int E</th><th>Int S</th><th>Int General</th><th>Int %</th>
                            </tr>
                            <tr>
                                <td><%= analisisHartman[0].fraseIntI %></td>
                                <td><%= analisisHartman[0].fraseIntE %></td>
                                <td><%= analisisHartman[0].fraseIntS %></td>
                                <td><%= analisisHartman[0].fraseIntGeneral %></td>
                                <td><%= analisisHartman[0].fraseIntPorcentaje %></td>
                            </tr>
                            <tr class="table-secondary">
                                <th>DiF</th><th>D.I</th><th>DIS</th><th>Vq1</th><th>Vq2</th><th>Ai%</th>
                            </tr>
                            <tr>
                                <td><%= analisisHartman[0].fraseDif %></td>
                                <td><%= analisisHartman[0].fraseDi %></td>
                                <td><%= analisisHartman[0].fraseDIS %></td>
                                <td><%= analisisHartman[0].fraseVQ1 %></td>
                                <td><%= analisisHartman[0].fraseVQ2 %></td>
                                <td><%= analisisHartman[0].fraseAiPorcentaje %></td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- Equilibrio -->
                <h5 class="fw-semibold mt-5">Equilibrio</h5>
                <div class="table-responsive">
                    <table class="table table-bordered table-sm table-hover align-middle">
                        <thead class="table-dark">
                            <tr>
                                <th>Área</th><th>Bqr1</th><th>Bqr2</th><th>Bqa1</th><th>Bqa2</th><th>Cq1</th><th>Cq2</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Equilibrio</strong></td>
                                <td><%= analisisHartman[0].BQr1.toFixed(2) %></td>
                                <td><%= analisisHartman[0].BQr2.toFixed(2) %></td>
                                <td><%= analisisHartman[0].BQa1.toFixed(2) %></td>
                                <td><%= analisisHartman[0].BQa2.toFixed(2) %></td>
                                <td><%= analisisHartman[0].CQ1.toFixed(2) %></td>
                                <td><%= analisisHartman[0].CQ2.toFixed(2) %></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            
            <!-- Botón de regresar -->
            <div class="boton-container mt-4 text-center">
                <a class="btn btn-color--third" href="/psicologo/aspirantes/<%= idAspirante %>/<%= idGrupo %>/<%= idInstitucion %>">Regresar</a>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        const ctx = document.getElementById("chart").getContext("2d");
        const chart = new Chart(ctx, {
            type: "line",
            data: {
                labels: [
                    "DimI", "DimE", "DimS", "DiF", "DimGeneral", "DimPorcentaje",
                    "IntI", "IntE", "IntS", "IntGeneral", "IntPorcentaje",
                    "Di", "Dis", "Sq1/Vq1", "Sq2/Vq2",
                    "Bqr1", "Bqr2", "Bqa1", "Bqa2", "Cq1", "Cq2"
                ],
                datasets: [
                    {
                        label: "Mundo Interno",
                        data: [
                            <%= datos.MundoInterno.DimI %>, <%= datos.MundoInterno.DimE %>, <%= datos.MundoInterno.DimS %>,
                            <%= datos.MundoInterno.DiF %>, <%= datos.MundoInterno.DimGeneral %>, <%= datos.MundoInterno.DimPorcentaje %>,
                            <%= datos.MundoInterno.IntI %>, <%= datos.MundoInterno.IntE %>, <%= datos.MundoInterno.IntS %>,
                            <%= datos.MundoInterno.IntGeneral %>, <%= datos.MundoInterno.IntPorcentaje %>,
                            <%= datos.MundoInterno.Di %>, <%= datos.MundoInterno.Dis %>,
                            <%= datos.MundoInterno.Sq1 %>, <%= datos.MundoInterno.Sq2 %>,
                            null, null, null, null, null, null
                        ],
                        borderColor: "red",
                        backgroundColor: "rgba(255, 0, 0, 0.2)",
                        fill: false,
                        tension: 0.1,
                        borderWidth: 2,
                        pointRadius: 3,
                        pointBackgroundColor: "red",
                    },
                    {
                        label: "Mundo Externo",
                        data: [ <%= datos.MundoExterno.DimI %>,<%= datos.MundoExterno.DimE %>, <%= datos.MundoExterno.DimS %>,
                            <%= datos.MundoExterno.DiF %>, <%= datos.MundoExterno.DimGeneral %>, <%= datos.MundoExterno.DimPorcentaje %>,
                            <%= datos.MundoExterno.IntI %>, <%= datos.MundoExterno.IntE %>, <%= datos.MundoExterno.IntS %>,
                            <%= datos.MundoExterno.IntGeneral %>, <%= datos.MundoExterno.IntPorcentaje %>,
                            <%= datos.MundoExterno.Di %>, <%= datos.MundoExterno.Dis %>,
                            <%= datos.MundoExterno.Sq1 %>, <%= datos.MundoExterno.Sq2 %>,
                            null, null, null, null, null, null
                        ],
                        borderColor: "blue",
                        backgroundColor: "rgba(0, 0, 255, 0.2)",
                        fill: false,
                        tension: 0.1,
                        borderWidth: 2,
                        pointRadius: 3,
                        pointBackgroundColor: "blue",
                    },
                    {
                        label: "Equilibrio",
                        data: [
                            null, null, null, null, null, null,
                            null, null, null, null, null,
                            null, null, null, null,
                            <%= datos.Equilibrio.Bqr1 %>, <%= datos.Equilibrio.Bqr2 %>,
                            <%= datos.Equilibrio.Bqa1 %>, <%= datos.Equilibrio.Bqa2 %>,
                            <%= datos.Equilibrio.Cq1 %>, <%= datos.Equilibrio.Cq2 %>
                        ],
                        borderColor: "black",
                        backgroundColor: "rgba(0, 0, 0, 0.2)",
                        fill: false,
                        tension: 0.1,
                        borderWidth: 2,
                        pointRadius: 3,
                        pointBackgroundColor: "black",
                    }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    title: {
                        display: true,
                        text: "Gráfico de Líneas: Análisis Hartman",
                        font: {
                            size: 16,
                            weight: 'bold'
                        },
                        padding: {
                            top: 10,
                            bottom: 20
                        }
                    },
                    legend: {
                        position: "bottom",
                        labels: {
                            padding: 20,
                            boxWidth: 15,
                            font: {
                                size: 12
                            }
                        }
                    },
                    tooltip: {
                        enabled: true,
                        backgroundColor: 'rgba(0, 0, 0, 0.7)',
                        titleFont: {
                            size: 13
                        },
                        bodyFont: {
                            size: 12
                        },
                        padding: 10
                    }
                },
                hover: {
                    mode: "nearest",
                    intersect: false
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        title: {
                            display: true,
                            text: "Valor",
                            font: {
                                size: 14,
                                weight: 'bold'
                            }
                        },
                        grid: {
                            color: 'rgba(0, 0, 0, 0.1)'
                        },
                        ticks: {
                            font: {
                                size: 11
                            }
                        }
                    },
                    x: {
                        grid: {
                            color: 'rgba(0, 0, 0, 0.1)'
                        },
                        ticks: {
                            font: {
                                size: 10
                            },
                            maxRotation: 45,
                            minRotation: 45
                        }
                    }
                },
                animation: {
                    duration: 1000,
                    easing: 'easeOutQuart'
                }
            }
        });
    </script>
</body>
</html>